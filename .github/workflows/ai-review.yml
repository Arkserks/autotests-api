name: ü§ñ AI Review

on:
  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∏–∑ –≤–∫–ª–∞–¥–∫–∏ Actions (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ on: pull_request)
  workflow_dispatch:
    inputs:
      review-command:
        type: choice
        default: "run"
        options: [ run, run-inline, run-context, run-summary, run-inline-reply, run-summary-reply ]
        required: true
        description: "AI Review command"

      pull-request-number:
        type: string
        required: true
        description: "Pull request number"

jobs:
  ai-review:
    name: Run AI Review
    runs-on: ubuntu-latest
    steps:
      # 1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–æ–ª—É—á–∞–µ–º diff –∏–∑–º–µ–Ω–µ–Ω–∏–π
      - name: üß± Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # 2Ô∏è‚É£ –ó–∞–ø—É—Å–∫–∞–µ–º AI Review
      - name: üöÄ Run AI Review
        uses: Nikita-Filonov/ai-review@v0.36.0
        env:
          # üîë –¢–æ–∫–µ–Ω GitHub –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Pull Request –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
          VCS__HTTP_CLIENT__API_TOKEN: ${{ secrets.GITHUB_TOKEN }}

          # üì¶ –ö–æ–Ω—Ç–µ–∫—Å—Ç PR ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–æ–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
          VCS__PIPELINE__OWNER: ${{ github.repository_owner }}
          VCS__PIPELINE__REPO: ${{ github.event.repository.name }}
          VCS__PIPELINE__PULL_NUMBER: ${{ inputs.pull-request-number }}

          # ü§ñ –¢–æ–∫–µ–Ω OpenRouter –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ LLM
          LLM__HTTP_CLIENT__API_TOKEN: ${{ secrets.OPENROUTER_API_TOKEN }}

        with:
          # üß† –ö–æ–º–∞–Ω–¥–∞ —Ä–µ–≤—å—é: –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —Ç–æ–ª—å–∫–æ inline, —Ç–æ–ª—å–∫–æ summary –∏ —Ç.–¥.
          review-command: ${{ inputs.review-command }}
